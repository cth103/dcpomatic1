def build(bld):
    obj = bld(features = 'cxx cxxshlib')
    obj.name = 'libdvdomatic'
    obj.export_includes = ['.']
    obj.uselib = 'AVCODEC AVUTIL AVFORMAT AVFILTER SWSCALE SWRESAMPLE SNDFILE BOOST_FILESYSTEM BOOST_THREAD BOOST_DATETIME OPENJPEG POSTPROC TIFF SIGC++ MAGICK SSH DCP GLIB'
    if bld.env.TARGET_WINDOWS:
        obj.uselib += ' WINSOCK2'
    obj.source = """
		 ab_transcode_job.cc
		 ab_transcoder.cc
                 check_hashes_job.cc
		 config.cc
		 copy_from_dvd_job.cc
                 cross.cc
		 dcp_content_type.cc
		 dcp_video_frame.cc
                 decoder.cc
                 decoder_factory.cc
                 delay_line.cc
                 dolby_cp750.cc
                 dvd.cc
		 encoder.cc
                 encoder_factory.cc
		 examine_content_job.cc
                 ffmpeg_compatibility.cc
                 ffmpeg_decoder.cc
    	         film.cc
		 film_state.cc
		 filter.cc
		 format.cc
                 image.cc
                 imagemagick_decoder.cc
                 imagemagick_encoder.cc
		 j2k_still_encoder.cc
		 j2k_wav_encoder.cc
		 job.cc
		 job_manager.cc
		 log.cc
		 lut.cc
		 make_dcp_job.cc
                 scp_dcp_job.cc
		 scaler.cc
                 screen.cc
		 server.cc
                 sound_processor.cc
                 stream.cc
                 subtitle.cc
		 thumbs_job.cc
                 tiff_decoder.cc
                 timer.cc
		 transcode_job.cc
		 transcoder.cc
		 util.cc
		 version.cc
		 """

    if not bld.env.DISABLE_PLAYER:
        obj.source += " player.cc player_manager.cc"

    obj.target = 'dvdomatic'
